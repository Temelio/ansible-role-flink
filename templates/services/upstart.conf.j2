# {{ ansible_managed }}

description "{{ flink_service_description }}"

start on (local-filesystems and net-device-up IFACE!=lo)
stop on shutdown

respawn
respawn limit 7 5

# Ensure pid dir exists
pre-start script
    mkdir -p {{ flink_pid_dir.path }}
    chown {{ flink_user.name }}:{{ flink_group.name }} {{ flink_pid_dir.path }}
    chmod {{ flink_pid_dir.mode }} {{ flink_pid_dir.path }}
end script

# Launch flink
chdir {{ flink_root_dir.path }}/current
exec bin/flink-daemon.sh upstart
